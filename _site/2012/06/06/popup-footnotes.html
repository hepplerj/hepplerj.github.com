<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta content="The online writing of Jason Heppler" name="description"/>
<title>Popup Footnotes</title> <meta name="author" content="Jason Heppler" />
<link rel="stylesheet" href="/css/syntax.css" type="text/css" />
<link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
<link rel="stylesheet" href="/css/tweet.css" type="text/css" />
<link href="/webfonts/ss-social.css" rel="stylesheet" />
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="http://jasonheppler.org/js/styleTweets.js"></script>

<link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

<script src="http://d3js.org/d3.v3.min.js"></script>

<style>

.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}

.bar {
  fill: steelblue;
}

.x.axis path {
  display: none;
}

svg {
  font: 13px sans-serif;
}

</style>

   <script type="text/javascript">

     var _gaq = _gaq || [];
     _gaq.push(['_setAccount', 'UA-12786552-1']);
     _gaq.push(['_trackPageview']);

     (function() {
       var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
       ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
     })();

   </script>

</head>
<body>

<div class="header">
	<div class="header_container">

		<section class="name"><a href="/">Jason Heppler</a></section>
		<ul class="menu">
			<li><a href="/about.html">Colophon</a></li>
			<li><a href="/research.html">Research</a></li>
			<li><a href="/teaching.html">Teaching</a></li>
			<li><a href="/hacks.html">Digital &amp; Public History</a></li>
			<li><a href="http://jasonheppler.org/jah-vita.pdf">Vita</a></li>
		</ul>
	</div>
</div>

<section class="container content">

<aside><p class="when">June  6, 2012</p></aside>
<h1>Popup Footnotes</h1>

<p>After discovering <a href="http://www.leancrew.com/all-this/2010/05/a-small-popup-footnote-change/">this post</a> by Dr. Drang about popup footnotes, I&#8217;ve added the feature to my blog. Now, thanks to some jQuery, when you hover your mouse over a footnote link you&#8217;ll see a popup box.<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup></p>

<p>What I like about the implementation is it improves readability. Rather than jumping to the bottom of the post, the footnote appears with the main body of the text and disappears when you&#8217;re finished with it. </p>

<p>The code is pretty straight forward:</p>

<div class="highlight"><pre><code class="javascript"><span class="c1">// this script requires jQuery</span>
<span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">Footnotes</span><span class="p">.</span><span class="nx">setup</span><span class="p">();</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">Footnotes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">footnotetimeout</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">setup</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">footnotelinks</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;a[rel=&#39;footnote&#39;]&quot;</span><span class="p">)</span>
        
        <span class="nx">footnotelinks</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnoteover</span><span class="p">);</span>
        <span class="nx">footnotelinks</span><span class="p">.</span><span class="nx">unbind</span><span class="p">(</span><span class="s1">&#39;mouseout&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnoteoout</span><span class="p">);</span>
        
        <span class="nx">footnotelinks</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnoteover</span><span class="p">);</span>
        <span class="nx">footnotelinks</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;mouseout&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnoteoout</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">footnoteover</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnotetimeout</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">stop</span><span class="p">();</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
        
        <span class="kd">var</span> <span class="nx">id</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">).</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">position</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">offset</span><span class="p">();</span>
    
        <span class="kd">var</span> <span class="nx">div</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">));</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;footnotediv&#39;</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;mouseover&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">divover</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;mouseout&#39;</span><span class="p">,</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnoteoout</span><span class="p">);</span>

        <span class="kd">var</span> <span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">el</span><span class="p">).</span><span class="nx">html</span><span class="p">());</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">&quot;a[rev=&#39;footnote&#39;]&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
        
        <span class="nx">div</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
            <span class="nx">position</span><span class="o">:</span><span class="s1">&#39;absolute&#39;</span><span class="p">,</span>
            <span class="nx">width</span><span class="o">:</span><span class="s1">&#39;20em&#39;</span><span class="p">,</span>
            <span class="nx">background</span><span class="o">:</span><span class="s1">&#39;#F7F6EE&#39;</span><span class="p">,</span>
            <span class="nx">padding</span><span class="o">:</span><span class="s1">&#39;0em 1em 0em 1em&#39;</span><span class="p">,</span>
            <span class="nx">border</span><span class="o">:</span><span class="s1">&#39;solid 1px&#39;</span><span class="p">,</span>
            <span class="s1">&#39;font-size&#39;</span><span class="o">:</span><span class="s1">&#39;90%&#39;</span><span class="p">,</span>
            <span class="s1">&#39;font-family&#39;</span><span class="o">:</span> <span class="s1">&#39;Helvetica, Sans-serif&#39;</span><span class="p">,</span>
            <span class="s1">&#39;line-height&#39;</span><span class="o">:</span><span class="mf">1.4</span><span class="p">,</span>
            <span class="s1">&#39;-moz-border-radius&#39;</span><span class="o">:</span><span class="s1">&#39;.5em&#39;</span><span class="p">,</span>
            <span class="s1">&#39;-webkit-border-radius&#39;</span><span class="o">:</span><span class="s1">&#39;.5em&#39;</span><span class="p">,</span>
            <span class="s1">&#39;border-radius&#39;</span><span class="o">:</span><span class="s1">&#39;.5em&#39;</span><span class="p">,</span>
            <span class="nx">opacity</span><span class="o">:</span><span class="mf">0.95</span>
        <span class="p">});</span>
        <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">div</span><span class="p">);</span>
        

        <span class="kd">var</span> <span class="nx">left</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">left</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">left</span> <span class="o">+</span> <span class="mi">420</span>  <span class="o">&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">())</span>
            <span class="nx">left</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">width</span><span class="p">()</span> <span class="o">-</span> <span class="mi">420</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">top</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">top</span><span class="o">+</span><span class="mi">20</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">div</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">height</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">())</span>
            <span class="nx">top</span> <span class="o">=</span> <span class="nx">position</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">div</span><span class="p">.</span><span class="nx">height</span><span class="p">()</span> <span class="o">-</span> <span class="mi">15</span><span class="p">;</span>
        <span class="nx">div</span><span class="p">.</span><span class="nx">css</span><span class="p">({</span>
            <span class="nx">left</span><span class="o">:</span><span class="nx">left</span><span class="p">,</span>
            <span class="nx">top</span><span class="o">:</span><span class="nx">top</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">footnoteoout</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnotetimeout</span> <span class="o">=</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">animate</span><span class="p">({</span>
                <span class="nx">opacity</span><span class="o">:</span> <span class="mi">0</span>
            <span class="p">},</span> <span class="mi">600</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
            <span class="p">});</span>
        <span class="p">},</span><span class="mi">100</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">divover</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">clearTimeout</span><span class="p">(</span><span class="nx">Footnotes</span><span class="p">.</span><span class="nx">footnotetimeout</span><span class="p">);</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">stop</span><span class="p">();</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#footnotediv&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">({</span>
                <span class="nx">opacity</span><span class="o">:</span> <span class="mf">0.9</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<p>I&#8217;ve also switched my Jekyll markdown conversion to <a href="https://github.com/gettalong/kramdown">kramdown</a> (having previously used <a href="https://github.com/rtomayko/rdiscount">rdiscount</a>), which handles the creation of footnotes and inserts the return character (↩) and hyperlinking between the number and the note.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Like this!<a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>


<section class="post_meta">
  <div class="block">
    <a href="http://twitter.com/jaheppler">
      <span class="ss-twitter ss-social-circle">
        <div>Follow me on Twitter.</div>
      </span>
    </a>
  </div>
  
  <div class="block">
  	<a href="http://acomp.stanford.edu/faculty/atsp">
  		<span class="ss-like ss-social-circle">
  			<div>I am the Academic Technology Specialist in the History Department at Stanford University.</div>
  		</span>
  	</a>
  </div>

  <div class="block">
  	<a href="http://github.com/hepplerj">
  		<span class="ss-github ss-social-circle">
  			<div>Follow me on Github.</div>
  		</span>
  	</a>
  </div>
</section>


</section>

<footer>
	Tech, history, code, coffee • Written by <a href="http://jasonheppler.org/about.html">Jason Heppler</a> • Powered by <a href="http://github.com/mojombo/jekyll">Jekyll</a> <br/> Licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC-BY</a> • <a href="http://www.jasonheppler.org/feed.xml">Subscribe to RSS</a>

<br>

Remember <a href="http://lessig.tumblr.com/post/40347463044/prosecutor-as-bully">Aaron Swartz</a>

</footer>

</body>
</html>
